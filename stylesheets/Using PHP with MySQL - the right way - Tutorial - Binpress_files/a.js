;(function($){var binpress=window.binpress={init:function(){this.share();this.initToggles();this.initContentTabs();if($('#register-popup').length==1){this.initNonUserForm();}
this.initMobileNav();},initNonUserForm:function(){var self=this;var tabs=$('#register-popup .tabs li');tabs.click(function(){if(!$(this).is('.on')){var pos=tabs.index(this);tabs.filter('.on').removeClass('on');$(this).addClass('on');$('#register-popup .tab').hide().eq(pos).show().find("input[type='text']:first")[0].focus();}});$('#register-popup form .pw,#register-popup form .image_reg').remove();$('#register-popup .register').submit(function(e){$('#register-popup .error').remove();e.preventDefault();var data=$(this).serialize();$.post('register/ajax',data,function(response){if(response==1){$('#register-popup .tab').hide().eq(2).show();}else{response=eval('('+response+')');for(var el in response.errors){var error=response.errors[el];self.error($("#register-popup .register input[name='"+el+"']"),error,'error');}}});});$('.must-be-logged').click(function(e){if($('#register-popup').length==0){return true;}
e.stopPropagation();e.preventDefault();binpress.media.overlay($('#register-popup'));});},error:function(el,text,cls){cls=cls||'error-message';var pos=$(el).position();var width=$(el).width();var tip=$('<span class="'+cls+'">'+text+'</span>').insertAfter(el).css({width:width}).fadeIn();var padding=(tip.innerWidth()-tip.width())/2;tip.width(width-padding);tip.position({my:"left top",at:"left bottom",of:el});$(tip).click(function(){tip.fadeOut(function(){$(this).remove()});});$(el).focus(function(){tip.fadeOut(function(){$(this).remove()});});},getUrl:function(button){if(!$(button).is('a')){return false;}
var url=$(button).attr('count-url');if(typeof(url)!='undefined'){return url;}else if($(button).attr('href').split('?').length>1){var parts=$(button).attr('href').split('?')[1].split('&'),keyval;for(var i in parts){keyval=parts[i].split('=');if(keyval[0]=='u'||keyval[0]=='url'){var url=keyval[1];return url;}}}
return window.location.href;},putCount:function(button){var page=this.getUrl(button);var $button=$(button);if($button.is('.facebook')){var url="https://graph.facebook.com/?id="+page+"&callback=?";$.getJSON(url,function(response){var likes=0;if(response.likes){likes+=response.likes;}
if(response.shares){likes+=response.shares;}
$button.attr('attr-count',likes);if(likes>0){$button.find('span').html(likes);}});}else if($button.is('.twitter')){var url='https://cdn.api.twitter.com/1/urls/count.json?url='+page+'&callback=?';$.getJSON(url,function(response){$button.attr('attr-count',response.count?response.count:0);if(response.count){$button.find('span').html(response.count);}});}else if($button.is('.hn')){var url="http://api.thriftdb.com/api.hnsearch.com/items/_search?filter[fields][url][]="+page+'&callback=?';$.getJSON(url,function(response){if(response.results&&response.results[0]){var score=response.results[0]['item']['points'];var id=response.results[0]['item']['id'];if(score>0){$button.find('span').html(score);var url='http://news.ycombinator.com/item?id='+id;$button.attr('href',url);}}});}else if($button.is('.gplus')){var url="index/gplus?url="+page;$.getJSON(url,function(response){if(response.count!=0){$button.find('span').html(response.count);}});}else if($button.is('.linkedin')){var url='https://www.linkedin.com/countserv/count/share?url='+page+'&callback=?';$.getJSON(url,function(response){$button.attr('attr-count',response.count?response.count:0);if(response.count>0){$button.find('span').html(response.count);}});}},share:function(){var self=this;$('.socialb').each(function(){var button=this;self.putCount(button);});$('.socialb.twitter,.socialb.facebook').click(function(e){e.preventDefault();var newwindow=window.open($(this).attr('href'),'sharing','height=480,width=600');if(window.focus){newwindow.focus();}});$('.social-buttons .share-link a').click(function(e){e.stopPropagation();e.preventDefault();$(this).parent().addClass('active');var link=$(this).parent().find('input');link[0].focus();link[0].select();});$('.social-buttons .share-link input').blur(function(){$(this).parent().removeClass('active');});},initMobileNav:function(){$(document).on("click",".toggler-button",function(e){var $this=$(this);var $content=$($this.data("toggler-content"));$content.toggleClass('toggler-active');$this.toggleClass('toggler-active');e.preventDefault();e.stopPropagation();return false;});$(document).on("click","#header .show-menu",function(e){$("#header .links-wrap").toggleClass('open');});},initToggles:function(){$('.toggle').click(function(){$(this).find('input[type="radio"]').not(':checked').prop("checked",true);$(this).find('input[type="radio"]').change();$(this).toggleClass('on').toggleClass('off');});},initContentTabs:function(){$(".container-tabs li a").click(function(){var tab=$(this).attr('href');$(this).parent().parent().find('.selected').removeClass('selected');$(this).parent().addClass('selected');$(".container-tab.active").removeClass('active');$(tab+".container-tab").addClass('active');return false;});},reviewPopup:function(){var popup=$("#please-review");if(popup.length==1){popup.find('.close').click(function(){var width=360;popup.animate({"right":"-"+width+"px"},function(){$(this).hide();});var id=$('#please-review').attr('attr-id');$.get("user/review/close");});window.setTimeout(function(){popup.animate({"right":0});},3000);}},abActivate:function(test){$.get('ab/activate',{test:test});},form:{validate:function(form,rules,callback){var self=this;$(form).data('rules',rules);var next=function(){self.resetButton(form);if($(form).find('.error').length>0){self.scrollToError();return false;}
if(typeof(callback)=='function'){callback();}else{$(form)[0].submit();}}
$(form).find("input,select").focus(function(){$(this).parent().find('.error-message').remove();}).blur(function(){self.isValid(this);});$(form).submit(function(e){e.stopPropagation();e.preventDefault();var button=$(this).find('button');button.data('html',button.html());button.css('min-width',button.width()).attr('disabled','disabled').html('Processing <span class="spinner"></span>');$(this).find("input,select").each(function(){if($(this).parent().is('.valid')){return;}else if(!$(this).parent().is('.error')&&$(this).data('loading')!==true){self.isValid(this);}});if($(form).is('.loading')){var interval=window.setInterval(function(){if(!$(form).is('.loading')){window.clearInterval(interval);next();}},50);}else{next();}});},isValid:function(el){var name=$(el).attr('attr-name');name=name||$(el).attr('name');if(typeof(name)=='undefined'||name==''){return;}
var rules=$(el).parents('form').data('rules');var validation=rules[name];if(typeof(validation)=='function'){validation.call(this,el);}else if(validation){for(var validator in validation){var msg=validation[validator];var valid=this.validators[validator].call(this,$(el).val(),el,msg);}
if(typeof(valid)!='undefined'){return this.result(valid,el,msg);}}},result:function(valid,el,msg){if(valid){$(el).parent().removeClass('error').addClass('valid').find('.spinner').remove();}else if(msg){this.showError(msg,el);return false;}else{$(el).parent().removeClass('valid').find('label').append('<span class="spinner dark-spin"></span>');return false;}},showError:function(msg,el){$(el).parent().removeClass('valid').addClass('error').find('.spinner').remove();var error=$('<span class="error-message">'+msg+'</span>').appendTo($(el).parent());return error;},scrollToError:function(){var error=$(".error-message");if(error.length==0){return;}
var to=error.eq(0).offset().top-90;var scrolled=$('html').prop('scrollTop');if(to-scrolled>500||to-scrolled<0){$('html,body').animate({scrollTop:to},600);}},validators:{Email:function(value,el,msg){var self=this;var url=$(el).attr('attr-target');var form=$(el).parents('form').addClass('loading');$(el).parent().append('<span class="spinner"></span>');$(el).data('loading',true);$.get(url,{email:value},function(response){$(el).data('loading',false);if(response==2){self.result(false,el,'Please enter valid Email address');}else if(response==1){self.result(false,el,msg);}else{self.result(true,el);}
form.removeClass('loading');});},Card:function(value,el,msg){return Stripe.card.validateCardNumber(value);},Expiry:function(value,el,msg){return Stripe.card.validateExpiry($(".card-expiry-month").val(),$(".card-expiry-year").val());},NotEmpty:function(value,el,msg){return value!='';}},resetButton:function(form){var button=$(form).find('button');button.attr('disabled',false).html(button.data('html'));}}};})(jQuery);$(document).ready(function(){binpress.init();});var Client={viewportWidth:function(){return self.innerWidth||(document.documentElement.clientWidth||document.body.clientWidth);},viewportHeight:function(){return self.innerHeight||(document.documentElement.clientHeight||document.body.clientHeight);},viewportSize:function(){return{width:this.viewportWidth(),height:this.viewportHeight()};}};window.log=function(name,msg){var debug=$('.debugger');if(debug.length==0){debug=$('<div class="debugger"></div>').appendTo($('body'));}
var el=debug.find('#'+name);if(el.length==0){el=$('<span id="'+name+'"></span>').appendTo(debug);}
el.html(name+': '+msg);};function round(value,precision,mode){var m,f,isHalf,sgn;precision|=0;m=Math.pow(10,precision);value*=m;sgn=(value>0)|-(value<0);isHalf=value%1===0.5*sgn;f=Math.floor(value);if(isHalf){switch(mode){case'PHP_ROUND_HALF_DOWN':value=f+(sgn<0);break;case'PHP_ROUND_HALF_EVEN':value=f+(f%2*sgn);break;case'PHP_ROUND_HALF_ODD':value=f+!(f%2);break;default:value=f+(sgn>0);}}
return(isHalf?value:Math.round(value))/m;}
(function(doc){var write=doc.write;doc.write=function(q){if(/docwriteregexwhitelist/.test(q))write.apply(doc,arguments);};})(document);;;(function(){binpress.media=binpress.media||{};$.extend(binpress.media,{events:function(container){var self=this;$('<div class="popup_overlay"><div id="media_container"></div><a class="next" title="Next">&nbsp;</a>'
+'<a class="prev" title="Previous">&nbsp;</a><a class="close"></a></div>').appendTo('body');$('.popup_overlay a.close').click(function(){self.close($(this).parents('.popup_overlay'));});},showimage:function(src,paginate){var self=this;var largeImage=document.createElement('img');$('#media_container').html('<img src="images/loading.gif" />');var popup=$('#media_container').parents('.popup_overlay');this.overlay(popup);if(paginate==true){popup.addClass('paginate');}else{popup.removeClass('paginate');}
$(largeImage).bind('load',function(){$('#media_container').html(largeImage);var w=$(window);if($(largeImage).attr('width')>w.width()-100||$(largeImage).attr('height')>w.height()-100){if($(largeImage).attr('width')/$(largeImage).attr('height')>w.width()/w.height()){$('#media_container img').width(w.width()-145);}else{$('#media_container img').height(w.height()-140);}}
var popup=$('#media_container').parents('.popup_overlay');self.overlay(popup);});largeImage.src=src;},overlay:function(element){this.center(element);if($('#overlay').length==0){var overlay=$('<div id="overlay"></div>').appendTo('body');var self=this;overlay.click(function(e){e.stopPropagation();self.close(element);});}},center:function(element){var display=$(element).css('display');$(element).show();var oWidth=$(element).outerWidth(true);var oHeight=$(element).outerHeight(true);$(element).css({display:display});var w=$(window);var position=$(element).css('position');var top=Math.max((w.height()-oHeight)/2,0)+15;if(position=='absolute'){top+=$(window).scrollTop();}
var left=Math.max((w.width()-oWidth)/2,0);var styles={top:top,left:left};$(element).css(styles).fadeIn(300);},close:function(popup){$(popup).fadeOut(200,function(){$('#overlay').remove();});}});})();